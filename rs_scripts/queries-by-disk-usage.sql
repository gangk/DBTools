SELECT count(*) FROM (SELECT q.query, trim(q.cat_text) FROM ( SELECT query, replace(listagg(text,' ') withIN GROUP ( ORDER BY SEQUENCE), 'n', ' ') AS cat_text FROM stl_querytext WHERE userid>1 GROUP BY query) q JOIN ( SELECT DISTINCT query FROM svl_query_summary WHERE is_diskbased='t' AND (LABEL LIKE 'hash%' OR LABEL LIKE 'sort%' OR LABEL LIKE 'aggr%') AND userid > 1) qs ON qs.query = q.query)tmp
